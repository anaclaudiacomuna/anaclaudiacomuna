var db=firebase.firestore();function addEvent(){var e=$("#calendar").evoCalendar("getActiveDate"),t=document.getElementById("title").value,a=document.getElementById("description").value,n=!!document.getElementById("yes").checked;document.getElementById("title").value="",document.getElementById("description").value="",document.getElementById("yes").checked=!0,db.collection("events").add({id:"",name:t,description:a,date:e,type:"event",everyYear:n}).then(t=>{db.collection("events").doc(t.id).update({id:t.id}).then(db.collection("events").doc(t.id).get().then(e=>{$("#calendar").evoCalendar("addCalendarEvent",[{id:t.id,name:e.data().name,description:e.data().description,date:e.data().date,everyYear:e.data().everyYear,type:e.data().type}])}))}).catch(e=>{console.error("Error adding document: ",e)})}function displayAvailableEvents(e){let a=document.getElementById("remove-selection");a.innerHTML="",a.innerHTML="<option selected>Escolha um evento para deletar</option>",e.map(e=>{let t=document.createElement("option");t.text=e.name,t.value=e.id,a.appendChild(t)})}function removeEvent(){var e=document.getElementById("remove-selection").value;$("#calendar").evoCalendar("removeCalendarEvent",e),db.collection("events").doc(e).delete().then(()=>{let e=db.collection("events"),t=$("#calendar").evoCalendar("getActiveDate");var a=t.slice(0,6);let n=e.where("date",">=",a).where("date","<=",a+"");n.get().then(e=>{let t=e.docs,a=[];for(let e=0;e<t.length;e++){var n=t[e].data();a.push(n)}displayAvailableEvents(a)})})}function getEventsFromDatabase(){db.collection("events").get().then(e=>{e.forEach(e=>{$("#calendar").evoCalendar("addCalendarEvent",[{id:e.id,name:e.data().name,description:e.data().description,date:e.data().date,type:e.data().type,everyYear:e.data().everyYear}])})})}function getTodayEvents(e,t,a){let n=db.collection("events"),d=$("#calendar").evoCalendar("getActiveDate");var l=d.slice(0,6);let o=n.where("date",">=",l).where("date","<=",l+"");o.get().then(e=>{let t=e.docs,a=[];for(let e=0;e<t.length;e++){var n=t[e].data();a.push(n)}displayAvailableEvents(a)})}$(function(){getEventsFromDatabase(),document.getElementById("add-button").addEventListener("click",addEvent),document.getElementById("remove-button").addEventListener("click",removeEvent),$("#calendar").on("selectDate",getTodayEvents)});